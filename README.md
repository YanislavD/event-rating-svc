# Event Rating Service

–ú–∏–∫—Ä–æ—Å—ä—Ä–≤–∏—Å –∑–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —Ä–µ–π—Ç–∏–Ω–≥–∏ –Ω–∞ —Å—ä–±–∏—Ç–∏—è. –¢–æ–≤–∞ –µ RESTful –º–∏–∫—Ä–æ—Å—ä—Ä–≤–∏—Å, –∫–æ–π—Ç–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–Ω–æ—Å—Ç –∑–∞ —Å—ä–∑–¥–∞–≤–∞–Ω–µ, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –∏–∑–≤–ª–∏—á–∞–Ω–µ –Ω–∞ —Ä–µ–π—Ç–∏–Ω–≥–∏ –∑–∞ —Å—ä–±–∏—Ç–∏—è.

## üìã –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ–Ω —Å—Ç–µ–∫

- **Java:** 17
- **Spring Boot:** 3.5.7
- **Build Tool:** Maven
- **Database:** MySQL
- **ORM:** Spring Data JPA
- **API:** RESTful API
- **Validation:** Jakarta Validation

## üéØ –û—Å–Ω–æ–≤–Ω–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–Ω–æ—Å—Ç–∏

### 1. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —Ä–µ–π—Ç–∏–Ω–≥–∏
- **–°—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ —Ä–µ–π—Ç–∏–Ω–≥** - –°—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ –Ω–æ–≤ —Ä–µ–π—Ç–∏–Ω–≥ –∑–∞ —Å—ä–±–∏—Ç–∏–µ –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª (–æ—Ü–µ–Ω–∫–∞ –æ—Ç 1 –¥–æ 5)
- **–ü–æ–ª—É—á–∞–≤–∞–Ω–µ –Ω–∞ —Ä–µ–π—Ç–∏–Ω–≥–∏** - –ò–∑–≤–ª–∏—á–∞–Ω–µ –Ω–∞ –≤—Å–∏—á–∫–∏ —Ä–µ–π—Ç–∏–Ω–≥–∏ –∑–∞ –¥–∞–¥–µ–Ω–æ —Å—ä–±–∏—Ç–∏–µ
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ —Å—ä—â–µ—Å—Ç–≤—É–≤–∞—â —Ä–µ–π—Ç–∏–Ω–≥** - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–ª–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª –≤–µ—á–µ –µ –æ—Ü–µ–Ω–∏–ª —Å—ä–±–∏—Ç–∏–µ

### 2. –ó–∞—â–∏—Ç–∞ —Å—Ä–µ—â—É –¥—É–±–ª–∏—Ä–∞–Ω–∏ —Ä–µ–π—Ç–∏–Ω–≥–∏
- **–£–Ω–∏–∫–∞–ª–µ–Ω constraint** - –ë–∞–∑–∞ –¥–∞–Ω–Ω–∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–∞, —á–µ –≤—Å–µ–∫–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª –º–æ–∂–µ –¥–∞ –æ—Ü–µ–Ω–∏ –≤—Å—è–∫–æ —Å—ä–±–∏—Ç–∏–µ —Å–∞–º–æ –≤–µ–¥–Ω—ä–∂
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ** - –î–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–µ–¥–∏ —Å—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ —Ä–µ–π—Ç–∏–Ω–≥
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ constraint violations** - –ü—Ä–∞–≤–∏–ª–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ –≥—Ä–µ—à–∫–∏ –ø—Ä–∏ –æ–ø–∏—Ç –∑–∞ –¥—É–±–ª–∏—Ä–∞–Ω —Ä–µ–π—Ç–∏–Ω–≥

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω–∏

- **Database:** MySQL
- **ORM:** Spring Data JPA
- **Primary Keys:** UUID
- **Unique Constraint:** –ö–æ–º–±–∏–Ω–∞—Ü–∏—è—Ç–∞ `(eventId, userId)` –µ —É–Ω–∏–∫–∞–ª–Ω–∞

### Entity
**Rating** - –†–µ–π—Ç–∏–Ω–≥ –Ω–∞ —Å—ä–±–∏—Ç–∏–µ
- `id` (UUID) - –£–Ω–∏–∫–∞–ª–µ–Ω –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- `eventId` (UUID) - –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –Ω–∞ —Å—ä–±–∏—Ç–∏–µ—Ç–æ
- `userId` (UUID) - –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –Ω–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è
- `score` (Integer, 1-5) - –û—Ü–µ–Ω–∫–∞ –æ—Ç 1 –¥–æ 5
- `createdOn` (LocalDateTime) - –î–∞—Ç–∞ –Ω–∞ —Å—ä–∑–¥–∞–≤–∞–Ω–µ
- `updatedOn` (LocalDateTime) - –î–∞—Ç–∞ –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∞ –ø—Ä–æ–º—è–Ω–∞

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
event-rating-svc/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ main/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ java/exam/eventratingsvc/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ model/          # Entity –∫–ª–∞—Å–æ–≤–µ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ repository/     # JPA Repositories
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ service/        # Business logic
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ web/
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ dto/        # Data Transfer Objects
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ GlobalExceptionHandler.java
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ RatingController.java
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ resources/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ application.properties
‚îÇ   ‚îî‚îÄ‚îÄ test/
‚îî‚îÄ‚îÄ pom.xml
```

## üöÄ –°—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –º–∏–∫—Ä–æ—Å—ä—Ä–≤–∏—Å–∞

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª–Ω–∏ –∏–∑–∏—Å–∫–≤–∞–Ω–∏—è
- Java 17 –∏–ª–∏ –ø–æ-–≤–∏—Å–æ–∫–∞ –≤–µ—Ä—Å–∏—è
- Maven 3.6+
- MySQL 8.0+

### –ò–Ω—Å—Ç–∞–ª–∞—Ü–∏—è

1. –ö–ª–æ–Ω–∏—Ä–∞–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:
```bash
git clone <repository-url>
cd event-rating-svc
```

2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–∞–π –±–∞–∑–∞—Ç–∞ –¥–∞–Ω–Ω–∏ –≤ `application.properties`:
```properties
spring.datasource.url=jdbc:mysql://localhost:3306/event_rating_db?createDatabaseIfNotExist=true&useSSL=false&serverTimezone=UTC
spring.datasource.username=root
spring.datasource.password=your_password
```

3. –°—Ç–∞—Ä—Ç–∏—Ä–∞–π –º–∏–∫—Ä–æ—Å—ä—Ä–≤–∏—Å–∞:
```bash
mvn spring-boot:run
```

4. –ú–∏–∫—Ä–æ—Å—ä—Ä–≤–∏—Å—ä—Ç —â–µ —Å—Ç–∞—Ä—Ç–∏—Ä–∞ –Ω–∞ –ø–æ—Ä—Ç **8081**

## üìã API Endpoints

### –†–µ–π—Ç–∏–Ω–≥–∏

#### –°—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ —Ä–µ–π—Ç–∏–Ω–≥
```
POST /ratings
Content-Type: application/json

{
  "eventId": "uuid",
  "userId": "uuid",
  "score": 5
}
```

**Response:**
- `201 Created` - –†–µ–π—Ç–∏–Ω–≥—ä—Ç –µ —Å—ä–∑–¥–∞–¥–µ–Ω —É—Å–ø–µ—à–Ω–æ
- `400 Bad Request` - –ù–µ–≤–∞–ª–∏–¥–Ω–∏ –¥–∞–Ω–Ω–∏ –∏–ª–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è—Ç –≤–µ—á–µ –µ –æ—Ü–µ–Ω–∏–ª —Ç–æ–≤–∞ —Å—ä–±–∏—Ç–∏–µ

#### –ü–æ–ª—É—á–∞–≤–∞–Ω–µ –Ω–∞ —Ä–µ–π—Ç–∏–Ω–≥–∏ –∑–∞ —Å—ä–±–∏—Ç–∏–µ
```
GET /ratings/event/{eventId}
```

**Response:**
```json
{
  "eventId": "uuid",
  "averageScore": 4.5,
  "totalRatings": 10,
  "ratings": [
    {
      "id": "uuid",
      "eventId": "uuid",
      "userId": "uuid",
      "score": 5,
      "createdOn": "2024-01-01T10:00:00",
      "updatedOn": "2024-01-01T10:00:00"
    }
  ]
}
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–ª–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª –µ –æ—Ü–µ–Ω–∏–ª —Å—ä–±–∏—Ç–∏–µ
```
GET /ratings/event/{eventId}/user/{userId}
```

**Response:**
- `200 OK` - `true` –∏–ª–∏ `false`

## üîß Error Handling

–ú–∏–∫—Ä–æ—Å—ä—Ä–≤–∏—Å—ä—Ç –≤–∫–ª—é—á–≤–∞ –≥–ª–æ–±–∞–ª–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ –≥—Ä–µ—à–∫–∏:
- **GlobalExceptionHandler** - –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–∏—Ä–∞–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ –∏–∑–∫–ª—é—á–µ–Ω–∏—è
- **IllegalArgumentException** - –í—Ä—ä—â–∞ HTTP 400 Bad Request
- **DataIntegrityViolationException** - –û–±—Ä–∞–±–æ—Ç–≤–∞ —Å–µ –ø—Ä–∏ –Ω–∞—Ä—É—à–∞–≤–∞–Ω–µ –Ω–∞ —É–Ω–∏–∫–∞–ª–Ω–∏—è constraint

## üîê –í–∞–ª–∏–¥–∞—Ü–∏—è

- **Score** - –¢—Ä—è–±–≤–∞ –¥–∞ –µ –º–µ–∂–¥—É 1 –∏ 5
- **EventId –∏ UserId** - –ó–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–∏ –ø–æ–ª–µ—Ç–∞
- **–£–Ω–∏–∫–∞–ª–µ–Ω constraint** - –í—Å–µ–∫–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª –º–æ–∂–µ –¥–∞ –æ—Ü–µ–Ω–∏ –≤—Å—è–∫–æ —Å—ä–±–∏—Ç–∏–µ —Å–∞–º–æ –≤–µ–¥–Ω—ä–∂

## üìä DTOs

### RatingRequest
```java
{
  "eventId": UUID,
  "userId": UUID,
  "score": Integer (1-5)
}
```

### RatingResponse
```java
{
  "id": UUID,
  "eventId": UUID,
  "userId": UUID,
  "score": Integer,
  "createdOn": LocalDateTime,
  "updatedOn": LocalDateTime
}
```

### EventRatingSummaryResponse
```java
{
  "eventId": UUID,
  "averageScore": Double,
  "totalRatings": Long,
  "ratings": List<RatingResponse>
}
```

## üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≥–ª–∞–≤–Ω–æ—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

–ú–∏–∫—Ä–æ—Å—ä—Ä–≤–∏—Å—ä—Ç —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞ –æ—Ç `EventApp` —á—Ä–µ–∑ Spring Cloud OpenFeign:
- **URL:** –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–∞ —Å–µ –≤ `EventApp` –≤ `application.properties` (`rating.service.url`)
- **–ü–æ—Ä—Ç:** –ü–æ –ø–æ–¥—Ä–∞–∑–±–∏—Ä–∞–Ω–µ 8081
- **–ü—Ä–æ—Ç–æ–∫–æ–ª:** HTTP REST

## üìù Logging

–ú–∏–∫—Ä–æ—Å—ä—Ä–≤–∏—Å—ä—Ç –ª–æ–≥–≤–∞:
- –£—Å–ø–µ—à–Ω–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–Ω–∞ INFO –Ω–∏–≤–æ)
- –ì—Ä–µ—à–∫–∏ (–Ω–∞ ERROR/WARN –Ω–∏–≤–æ)
- Constraint violations (–Ω–∞ WARN –Ω–∏–≤–æ)

## üß™ Testing

–ú–∏–∫—Ä–æ—Å—ä—Ä–≤–∏—Å—ä—Ç –≤–∫–ª—é—á–≤–∞ –∏–∑—á–µ—Ä–ø–∞—Ç–µ–ª–Ω–∏ —Ç–µ—Å—Ç–æ–≤–µ, –∫–æ–∏—Ç–æ –ø–æ–∫—Ä–∏–≤–∞—Ç –≤—Å–∏—á–∫–∏ –∏–∑–∏—Å–∫–≤–∞–Ω–∏—è:

### Test Coverage
- **Line Coverage: 83.3%** (45 –ø–æ–∫—Ä–∏—Ç–∏, 9 –ø—Ä–æ–ø—É—Å–Ω–∞—Ç–∏ —Ä–µ–¥–∞)
- **Instructions Coverage: 76%**
- **Branches Coverage: 50%**
- **Methods Coverage: 69.2%** (9 –ø–æ–∫—Ä–∏—Ç–∏, 4 –ø—Ä–æ–ø—É—Å–Ω–∞—Ç–∏)
- **Classes Coverage: 100%** (4 –ø–æ–∫—Ä–∏—Ç–∏ –∫–ª–∞—Å–∞)

### Unit Tests
- **RatingServiceTest** (2 —Ç–µ—Å—Ç–∞) - –¢–µ—Å—Ç–≤–∞ –±–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∞—Ç–∞ –Ω–∞ RatingService
  - `createRating_WhenRatingDoesNotExist_ShouldCreateRating`
  - `getRatingsForEvent_WhenRatingsExist_ShouldReturnSummary`

### Integration/API Tests
- **RatingControllerIntegrationTest** (2 —Ç–µ—Å—Ç–∞) - –¢–µ—Å—Ç–≤–∞ RatingController —Å —Ä–µ–∞–ª–Ω–∞ –±–∞–∑–∞
  - `createRating_WithValidRequest_ShouldReturnCreated` (API test)
  - `getRatingsForEvent_WhenRatingsExist_ShouldReturnSummary` (Integration test)

**–û–±—â–æ —Ç–µ—Å—Ç–æ–≤–µ:** 5 (–≤—Å–∏—á–∫–∏ –º–∏–Ω–∞–≤–∞—Ç —É—Å–ø–µ—à–Ω–æ)

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∑–∞ —Ç–µ—Å—Ç–≤–∞–Ω–µ
- **JUnit 5** - –ó–∞ –ø–∏—Å–∞–Ω–µ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–µ
- **Mockito** - –ó–∞ –º–æ–∫–∏—Ä–∞–Ω–µ –Ω–∞ dependencies –≤ unit —Ç–µ—Å—Ç–æ–≤–µ
- **Spring Boot Test** - –ó–∞ integration —Ç–µ—Å—Ç–æ–≤–µ —Å —Ä–µ–∞–ª–Ω–∞ –±–∞–∑–∞
- **MockMvc** - –ó–∞ —Ç–µ—Å—Ç–≤–∞–Ω–µ –Ω–∞ HTTP –∑–∞—è–≤–∫–∏ –≤ API —Ç–µ—Å—Ç–æ–≤–µ
- **JaCoCo** - –ó–∞ –∏–∑–º–µ—Ä–≤–∞–Ω–µ –Ω–∞ code coverage

### –°—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–µ—Ç–µ
```bash
# –°—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –≤—Å–∏—á–∫–∏ —Ç–µ—Å—Ç–æ–≤–µ
mvn clean test

# –ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ coverage —Ä–µ–ø–æ—Ä—Ç
mvn clean test jacoco:report

# Coverage —Ä–µ–ø–æ—Ä—Ç—ä—Ç —Å–µ –Ω–∞–º–∏—Ä–∞ –≤: target/site/jacoco/index.html
```

### –†—ä—á–Ω–æ —Ç–µ—Å—Ç–≤–∞–Ω–µ –Ω–∞ API endpoints
–ó–∞ —Ä—ä—á–Ω–æ —Ç–µ—Å—Ç–≤–∞–Ω–µ –Ω–∞ API endpoints –º–æ–∂–µ—à –¥–∞ –∏–∑–ø–æ–ª–∑–≤–∞—à:
- Postman
- cURL
- HTTP —Ñ–∞–π–ª (Rating.http) –≤ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–∏–º–µ—Ä –∑–∞ —Ç–µ—Å—Ç–≤–∞–Ω–µ:
```bash
curl -X POST http://localhost:8081/ratings \
  -H "Content-Type: application/json" \
  -d '{
    "eventId": "your-event-id",
    "userId": "your-user-id",
    "score": 5
  }'
```

## üìù License

–¢–æ–∑–∏ –ø—Ä–æ–µ–∫—Ç –µ —á–∞—Å—Ç –æ—Ç —É—á–µ–±–Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–∞ –Ω–∞ SoftUni.

## üë®‚Äçüíª –ê–≤—Ç–æ—Ä

–†–∞–∑—Ä–∞–±–æ—Ç–µ–Ω –∫–∞—Ç–æ —á–∞—Å—Ç –æ—Ç Spring Advanced –∫—É—Ä—Å –≤ SoftUni.

